@page "/courseeditor/{CourseId:int}"

@using SEIIApp.Shared
@using SEIIApp.Client.Components

@inject NavigationManager NavManager
@inject Services.CourseBackendAccessService CourseService

@if (CourseDto != null)
{

<h3>Course Editor</h3>
    <CourseDefComponent Course="CourseDto" />
    <button class="btn" @onclick="SaveCourseToBackend"><img src="icons/save_black_24dp.svg" /></button>
}
else
{
<h5>Course in loading (or not found) ...</h5>
}

@code {


    [Parameter]
    public int CourseId { get; set; }

    public CourseDto CourseDto { get; set; }


    protected override async Task OnParametersSetAsync() {
        if (CourseId != 0) {
            var existingCourse = await CourseService.GetCourseById(CourseId);
            PrepareEditOrAddOfCourse(existingCourse);
        }
        else {
            PrepareEditOrAddOfCourse(new CourseDto());
        }
        await base.OnParametersSetAsync();
    }

    private void PrepareEditOrAddOfCourse(CourseDto q) {
        this.CourseDto = q;
    }

    private void OnSubmit()
        {

        }

    private async void SaveCourseToBackend() {
        
        var answer = await CourseService.AddOrUpdateCourse(CourseDto);
        NavManager.NavigateTo("/courseeditor");

    }

}
